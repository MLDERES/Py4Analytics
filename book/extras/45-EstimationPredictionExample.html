
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Predicting the price of used cars &#8212; Python 4 Analytics</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" href="../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Python 4 Analytics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Welcome to your Jupyter Book
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Part 1
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../lessons/10-Introduction.html">
   In case something goes wrong
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/mlderes/py4analytics/main?urlpath=tree/book/extras/45-EstimationPredictionExample.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://waltonhub.com/hub/user-redirect/git-pull?repo=https%3A//github.com/mlderes/py4analytics&urlpath=tree/py4analytics/book/extras/45-EstimationPredictionExample.ipynb&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/mlderes/py4analytics"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/mlderes/py4analytics/issues/new?title=Issue%20on%20page%20%2Fbook/extras/45-EstimationPredictionExample.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../_sources/book/extras/45-EstimationPredictionExample.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#more-eda">
   More EDA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feature-importance">
   Feature importance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#making-predictions">
   Making predictions
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Predicting the price of used cars</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#more-eda">
   More EDA
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#feature-importance">
   Feature importance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#making-predictions">
   Making predictions
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">BaseEstimator</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span><span class="p">,</span> <span class="n">GridSearchCV</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">from</span> <span class="nn">sklearn.feature_selection</span> <span class="kn">import</span> <span class="n">SelectKBest</span><span class="p">,</span> <span class="n">f_regression</span>
<span class="kn">from</span> <span class="nn">sklearn.compose</span> <span class="kn">import</span> <span class="n">ColumnTransformer</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">OneHotEncoder</span><span class="p">,</span> <span class="n">OrdinalEncoder</span><span class="p">,</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">set_config</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">src.data</span> <span class="kn">import</span> <span class="n">load_data</span><span class="p">,</span> <span class="n">convert_to_bool</span><span class="p">,</span> <span class="n">convert_to_ordinal</span>
<span class="kn">from</span> <span class="nn">src.feature_selection</span> <span class="kn">import</span> <span class="n">FeatureImportance</span>

<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.precision&#39;</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s2">&quot;figure.figsize&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">IPython.core.interactiveshell</span> <span class="kn">import</span> <span class="n">InteractiveShell</span>
<span class="n">InteractiveShell</span><span class="o">.</span><span class="n">ast_node_interactivity</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span>
</pre></div>
</div>
</div>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="predicting-the-price-of-used-cars">
<h1>Predicting the price of used cars<a class="headerlink" href="#predicting-the-price-of-used-cars" title="Permalink to this headline">#</a></h1>
<p>In the data file <span class="xref myst">ToyotaCorrolla</span> we have data on used Toyotas from late 2004 in the Netherlands.  The goal is to predict the price based on it’s specifications.</p>
<p>Note there has been some significant EDA done ahead of time to reduce the number of columns and find interesting data.</p>
<ul class="simple">
<li><p>Cylinders: dropped because all the values are 4</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Let&#39;s start by checking out the data</span>
<span class="n">cars_df</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;ToyotaCorolla&#39;</span><span class="p">,</span><span class="n">index_col</span><span class="o">=</span><span class="s1">&#39;Id&#39;</span><span class="p">)</span>
<span class="n">cars_df</span> <span class="o">=</span> <span class="n">cars_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Cylinders&#39;</span><span class="p">,</span><span class="s1">&#39;Model&#39;</span><span class="p">])</span>
<span class="n">cars_df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/workspaces/AdvPythonML/data/ToyotaCorolla.csv
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1436, 36)
</pre></div>
</div>
</div>
</div>
<p><em>NOTE:</em> Maybe it’s worth noting (many notebooks leave these steps out because they are cumbersome and more complex to explain than to just do).  In a different notebook, I took a good look at the data to determine how to ensure that the data types were correct for each column.  You could do this in Excel (if your data is small enough) or you might use another tool where you can get a quick sample and try to understand the data.  For me, I took a look at the the types of data <code class="docutils literal notranslate"><span class="pre">cars_df.dtypes</span></code> then since I saw that many of the columns had just a 1 or a 0, I figured these were <code class="docutils literal notranslate"><span class="pre">boolean</span></code>.  Then looking at the names of the columns, like <code class="docutils literal notranslate"><span class="pre">Mfg_Year</span></code> and <code class="docutils literal notranslate"><span class="pre">Mfg_Month</span></code>, even though they are numbers, I felt it would be best to convert them what they are <em>ordinal</em> values.  The other reason that this doesn’t get much description is because the process is usually a bit non-linear and repeatitive.  For instance, once I determined the booleans, I converted them and then started looking for categoricals.  This would have taken 4 notebook cells (1. find bools, 2. convert columns to bool, 3. find non-bool number columns, 4. convert to ordinal).  As a reader you are really only interested in seeing the conversion of columns in a single cell instead of all the work behind it.</p>
<p>Another example of the non-linear workflow, I discovered <code class="docutils literal notranslate"><span class="pre">Cylinders</span></code> as a unary value (all cars here have 4 cylinders).  If this column was dropped later in the notebook, then an update to the categorical columns as well.  Instead, I’ll just let you know that I found this in a later step.  To be more clear, it was dropped immediately at the start before creating the categorical columns.  Additionally, I found later in the model that there are 300+ different car models in a dataset (within just 1400 rows), so this isn’t going to be helpful later on either.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cars_df</span><span class="o">.</span><span class="n">dtypes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Price                 int64
Age_08_04             int64
Mfg_Month             int64
Mfg_Year              int64
KM                    int64
Fuel_Type            object
HP                    int64
Met_Color             int64
Color                object
Automatic             int64
CC                    int64
Doors                 int64
Gears                 int64
Quarterly_Tax         int64
Weight                int64
Mfr_Guarantee         int64
BOVAG_Guarantee       int64
Guarantee_Period      int64
ABS                   int64
Airbag_1              int64
Airbag_2              int64
Airco                 int64
Automatic_airco       int64
Boardcomputer         int64
CD_Player             int64
Central_Lock          int64
Powered_Windows       int64
Power_Steering        int64
Radio                 int64
Mistlamps             int64
Sport_Model           int64
Backseat_Divider      int64
Metallic_Rim          int64
Radio_cassette        int64
Parking_Assistant     int64
Tow_Bar               int64
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cars_df</span> <span class="o">=</span> <span class="n">convert_to_bool</span><span class="p">(</span><span class="n">cars_df</span><span class="p">,[</span><span class="s1">&#39;Met_Color&#39;</span><span class="p">,</span> <span class="s1">&#39;Automatic&#39;</span><span class="p">,</span> <span class="s1">&#39;Mfr_Guarantee&#39;</span><span class="p">,</span> <span class="s1">&#39;BOVAG_Guarantee&#39;</span><span class="p">,</span> <span class="s1">&#39;ABS&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Airbag_1&#39;</span><span class="p">,</span> <span class="s1">&#39;Airbag_2&#39;</span><span class="p">,</span> <span class="s1">&#39;Airco&#39;</span><span class="p">,</span> <span class="s1">&#39;Automatic_airco&#39;</span><span class="p">,</span> <span class="s1">&#39;Boardcomputer&#39;</span><span class="p">,</span>
       <span class="s1">&#39;CD_Player&#39;</span><span class="p">,</span> <span class="s1">&#39;Central_Lock&#39;</span><span class="p">,</span> <span class="s1">&#39;Powered_Windows&#39;</span><span class="p">,</span> <span class="s1">&#39;Power_Steering&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Radio&#39;</span><span class="p">,</span> <span class="s1">&#39;Mistlamps&#39;</span><span class="p">,</span> <span class="s1">&#39;Sport_Model&#39;</span><span class="p">,</span> <span class="s1">&#39;Backseat_Divider&#39;</span><span class="p">,</span> <span class="s1">&#39;Metallic_Rim&#39;</span><span class="p">,</span>
       <span class="s1">&#39;Radio_cassette&#39;</span><span class="p">,</span> <span class="s1">&#39;Parking_Assistant&#39;</span><span class="p">,</span> <span class="s1">&#39;Tow_Bar&#39;</span><span class="p">])</span>

<span class="n">ord_columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Model&#39;</span><span class="p">,</span><span class="s1">&#39;Mfg_Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Mfg_Year&#39;</span><span class="p">,</span><span class="s1">&#39;Doors&#39;</span><span class="p">,</span> <span class="s1">&#39;Gears&#39;</span><span class="p">,</span><span class="s1">&#39;Fuel_Type&#39;</span><span class="p">,</span><span class="s2">&quot;Color&quot;</span><span class="p">]</span>

<span class="n">cars_df</span> <span class="o">=</span> <span class="n">convert_to_ordinal</span><span class="p">(</span><span class="n">cars_df</span><span class="p">,</span><span class="n">ord_columns</span><span class="p">)</span>

<span class="c1"># Take out the target column before determining the number columns</span>
<span class="n">num_columns</span> <span class="o">=</span> <span class="n">cars_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;number&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
<span class="n">bool_columns</span> <span class="o">=</span> <span class="n">cars_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
<span class="n">cat_columns</span> <span class="o">=</span> <span class="n">cars_df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">,</span><span class="s1">&#39;category&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>

<span class="nb">print</span><span class="p">(</span><span class="n">num_columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bool_columns</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cat_columns</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">remove_column</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_collection</span><span class="p">):</span>
       <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">       Drop a column from the dataframe, as well as from the list associated with the column</span>
<span class="sd">       &#39;&#39;&#39;</span>
       <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Age_08_04&#39;, &#39;KM&#39;, &#39;HP&#39;, &#39;Met_Color&#39;, &#39;Automatic&#39;, &#39;CC&#39;,
       &#39;Quarterly_Tax&#39;, &#39;Weight&#39;, &#39;Mfr_Guarantee&#39;, &#39;BOVAG_Guarantee&#39;,
       &#39;Guarantee_Period&#39;, &#39;ABS&#39;, &#39;Airbag_1&#39;, &#39;Airbag_2&#39;, &#39;Airco&#39;,
       &#39;Automatic_airco&#39;, &#39;Boardcomputer&#39;, &#39;CD_Player&#39;, &#39;Central_Lock&#39;,
       &#39;Powered_Windows&#39;, &#39;Power_Steering&#39;, &#39;Radio&#39;, &#39;Mistlamps&#39;,
       &#39;Sport_Model&#39;, &#39;Backseat_Divider&#39;, &#39;Metallic_Rim&#39;, &#39;Radio_cassette&#39;,
       &#39;Parking_Assistant&#39;, &#39;Tow_Bar&#39;],
      dtype=&#39;object&#39;)
Index([&#39;Met_Color&#39;, &#39;Automatic&#39;, &#39;Mfr_Guarantee&#39;, &#39;BOVAG_Guarantee&#39;, &#39;ABS&#39;,
       &#39;Airbag_1&#39;, &#39;Airbag_2&#39;, &#39;Airco&#39;, &#39;Automatic_airco&#39;, &#39;Boardcomputer&#39;,
       &#39;CD_Player&#39;, &#39;Central_Lock&#39;, &#39;Powered_Windows&#39;, &#39;Power_Steering&#39;,
       &#39;Radio&#39;, &#39;Mistlamps&#39;, &#39;Sport_Model&#39;, &#39;Backseat_Divider&#39;, &#39;Metallic_Rim&#39;,
       &#39;Radio_cassette&#39;, &#39;Parking_Assistant&#39;, &#39;Tow_Bar&#39;],
      dtype=&#39;object&#39;)
Index([&#39;Mfg_Month&#39;, &#39;Mfg_Year&#39;, &#39;Fuel_Type&#39;, &#39;Color&#39;, &#39;Doors&#39;, &#39;Gears&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<section id="more-eda">
<h2>More EDA<a class="headerlink" href="#more-eda" title="Permalink to this headline">#</a></h2>
<p>Next, I’m going to do a few more steps to see if I can determine anything interesting about the data.  I’ll start with a cumulative density plot of the price.  This helps me to see what the range of prices is and I’ve also plotted to the IQR’s, this can be helpful to see how spread out the prices are.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">iq1</span><span class="p">,</span><span class="n">iq2</span><span class="p">,</span><span class="n">iq3</span> <span class="o">=</span> <span class="n">cars_df</span><span class="o">.</span><span class="n">Price</span><span class="o">.</span><span class="n">describe</span><span class="p">()[</span><span class="mi">4</span><span class="p">:</span><span class="mi">7</span><span class="p">]</span>
<span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">cars_df</span><span class="o">.</span><span class="n">Price</span><span class="p">,</span> <span class="n">cumulative</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
<span class="n">y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cars_df</span><span class="o">.</span><span class="n">Price</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()),</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">cars_df</span><span class="o">.</span><span class="n">Price</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="mf">0.51</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Median: </span><span class="si">{</span><span class="n">iq2</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">cars_df</span><span class="o">.</span><span class="n">Price</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="mf">0.76</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;IQ3: </span><span class="si">{</span><span class="n">iq3</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="nb">max</span><span class="p">(</span><span class="n">cars_df</span><span class="o">.</span><span class="n">Price</span><span class="p">),</span><span class="n">y</span><span class="o">=</span><span class="mf">0.26</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;IQ1: </span><span class="si">{</span><span class="n">iq1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>

<span class="n">cars_df</span><span class="o">.</span><span class="n">Price</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Price&#39;, ylabel=&#39;Density&#39;&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x7f2b42b21460&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x7f2b48c9e520&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.lines.Line2D at 0x7f2b42f88670&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(3250.0, 0.51, &#39;Median: 9900.0&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(3250.0, 0.76, &#39;IQ3: 11950.0&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(3250.0, 0.26, &#39;IQ1: 8450.0&#39;)
</pre></div>
</div>
<img alt="../../_images/45-EstimationPredictionExample_7_7.png" src="../../_images/45-EstimationPredictionExample_7_7.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count     1436.0000
mean     10730.8245
std       3626.9646
min       4350.0000
25%       8450.0000
50%       9900.0000
75%      11950.0000
max      32500.0000
Name: Price, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Next, I want to see if  there are cases where there are too many of one class (bool or categorical)</span>
<span class="n">bool_df</span> <span class="o">=</span> <span class="n">cars_df</span><span class="p">[</span><span class="n">bool_columns</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">value_counts</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">bool_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">]</span>
<span class="n">bool_df</span><span class="p">[</span><span class="s1">&#39;% True&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">bool_df</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">bool_df</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">bool_df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;% True&#39;</span><span class="p">)</span>
<span class="n">cars_df</span><span class="p">[</span><span class="n">cat_columns</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>F</th>
      <th>T</th>
      <th>% True</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Parking_Assistant</th>
      <td>1432</td>
      <td>4</td>
      <td>0.0028</td>
    </tr>
    <tr>
      <th>Automatic</th>
      <td>1356</td>
      <td>80</td>
      <td>0.0557</td>
    </tr>
    <tr>
      <th>Automatic_airco</th>
      <td>1355</td>
      <td>81</td>
      <td>0.0564</td>
    </tr>
    <tr>
      <th>Radio_cassette</th>
      <td>1227</td>
      <td>209</td>
      <td>0.1455</td>
    </tr>
    <tr>
      <th>Radio</th>
      <td>1226</td>
      <td>210</td>
      <td>0.1462</td>
    </tr>
    <tr>
      <th>Metallic_Rim</th>
      <td>1142</td>
      <td>294</td>
      <td>0.2047</td>
    </tr>
    <tr>
      <th>CD_Player</th>
      <td>1122</td>
      <td>314</td>
      <td>0.2187</td>
    </tr>
    <tr>
      <th>Mistlamps</th>
      <td>1067</td>
      <td>369</td>
      <td>0.257</td>
    </tr>
    <tr>
      <th>Tow_Bar</th>
      <td>1037</td>
      <td>399</td>
      <td>0.2779</td>
    </tr>
    <tr>
      <th>Boardcomputer</th>
      <td>1013</td>
      <td>423</td>
      <td>0.2946</td>
    </tr>
    <tr>
      <th>Sport_Model</th>
      <td>1005</td>
      <td>431</td>
      <td>0.3001</td>
    </tr>
    <tr>
      <th>Mfr_Guarantee</th>
      <td>848</td>
      <td>588</td>
      <td>0.4095</td>
    </tr>
    <tr>
      <th>Airco</th>
      <td>706</td>
      <td>730</td>
      <td>0.5084</td>
    </tr>
    <tr>
      <th>Powered_Windows</th>
      <td>629</td>
      <td>807</td>
      <td>0.562</td>
    </tr>
    <tr>
      <th>Central_Lock</th>
      <td>603</td>
      <td>833</td>
      <td>0.5801</td>
    </tr>
    <tr>
      <th>Met_Color</th>
      <td>467</td>
      <td>969</td>
      <td>0.6748</td>
    </tr>
    <tr>
      <th>Airbag_2</th>
      <td>398</td>
      <td>1038</td>
      <td>0.7228</td>
    </tr>
    <tr>
      <th>Backseat_Divider</th>
      <td>330</td>
      <td>1106</td>
      <td>0.7702</td>
    </tr>
    <tr>
      <th>ABS</th>
      <td>268</td>
      <td>1168</td>
      <td>0.8134</td>
    </tr>
    <tr>
      <th>BOVAG_Guarantee</th>
      <td>150</td>
      <td>1286</td>
      <td>0.8955</td>
    </tr>
    <tr>
      <th>Airbag_1</th>
      <td>42</td>
      <td>1394</td>
      <td>0.9708</td>
    </tr>
    <tr>
      <th>Power_Steering</th>
      <td>32</td>
      <td>1404</td>
      <td>0.9777</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mfg_Month    12
Mfg_Year      7
Fuel_Type     3
Color        10
Doors         4
Gears         4
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Looking at the values above, it seems like <code class="docutils literal notranslate"><span class="pre">Parking_Assist</span></code> is pretty much useless in terms of determining the price since there are only 4 cars with this feature - I’ll remove it from the categoricals.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now let&#39;s see how these categoricals relate to price</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">));</span>
<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">,</span><span class="n">cat_columns</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">cars_df</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">,</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Mfg_Year&#39;, ylabel=&#39;Price&#39;&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Fuel_Type&#39;, ylabel=&#39;Price&#39;&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Color&#39;, ylabel=&#39;Price&#39;&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Doors&#39;, ylabel=&#39;Price&#39;&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:xlabel=&#39;Gears&#39;, ylabel=&#39;Price&#39;&gt;
</pre></div>
</div>
<img alt="../../_images/45-EstimationPredictionExample_10_5.png" src="../../_images/45-EstimationPredictionExample_10_5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We see above that it looks like these values may have some interest (certainly the newer the car the more valuable)</span>
<span class="c1"># There seems to be a small number of 2-doors let&#39;s see</span>
<span class="n">cars_df</span><span class="p">[</span><span class="s1">&#39;Doors&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5    674
3    622
4    138
2      2
Name: Doors, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># With only 2 samples of 2-door cars, we can safely drop these</span>
<span class="n">cars_df</span> <span class="o">=</span> <span class="n">cars_df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Doors&gt;2&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Next I noticed that the price seems to differ for each color pretty significantly</span>
<span class="n">colors_df</span> <span class="o">=</span> <span class="n">cars_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Color&#39;</span><span class="p">)[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">colors_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Color&#39;</span><span class="p">,</span><span class="s1">&#39;MeanPrice&#39;</span><span class="p">]</span>
<span class="n">colors_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Color
Yellow    12531.6667
Grey      11927.3422
Black     11085.1058
Silver    11070.6803
Blue      10836.4382
Red        9962.6978
Green      9836.1091
Violet     9575.0000
Beige      8933.3333
White      8207.9032
Name: Price, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="feature-importance">
<h2>Feature importance<a class="headerlink" href="#feature-importance" title="Permalink to this headline">#</a></h2>
<p>Many of the notebooks you see or some of the examples, skip the step where show how they determined that they only want to use 6-8 of the features that are provided.  I’m going to start by looking at which features are best using a DT regressor, a LinearModel with ForwardSelection and Backward elimination, once we’ve done this - we can start again by dropping out the features that don’t seem to have any value</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">set_config</span>
<span class="n">set_config</span><span class="p">(</span><span class="n">display</span><span class="o">=</span><span class="s1">&#39;diagram&#39;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">cars_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">)</span>
<span class="n">y</span><span class="o">=</span> <span class="n">cars_df</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">test_size</span> <span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">cat_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mfg_Month&#39;</span><span class="p">,</span><span class="s1">&#39;Fuel_Type&#39;</span><span class="p">,</span><span class="s1">&#39;Color&#39;</span><span class="p">]</span>
<span class="n">ord_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mfg_Year&#39;</span><span class="p">,</span><span class="s1">&#39;Doors&#39;</span><span class="p">,</span> <span class="s1">&#39;Gears&#39;</span><span class="p">]</span>
<span class="n">bool_cols</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
<span class="n">num_cols</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>

<span class="c1"># We&#39;re going to setup our column transformer as pre-processing step for the follow-on steps.</span>
<span class="n">pre_processing</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;cat_encoder&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(),</span> <span class="n">cat_cols</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;ord_encoder&#39;</span><span class="p">,</span> <span class="n">OrdinalEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;use_encoded_value&#39;</span><span class="p">,</span><span class="n">unknown_value</span><span class="o">=</span><span class="mi">99</span><span class="p">),</span> <span class="n">ord_cols</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;num_encoder&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span><span class="n">num_cols</span><span class="p">)])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s2">&quot;pp&quot;</span><span class="p">,</span><span class="n">pre_processing</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;dtr&quot;</span><span class="p">,</span><span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">))])</span>

<span class="n">pipe</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span>
<span class="n">fi</span><span class="o">=</span> <span class="n">FeatureImportance</span><span class="p">(</span><span class="n">pipe</span><span class="p">)</span>
<span class="n">fn</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">get_feature_names</span><span class="p">()</span>
<span class="n">top_10_tree</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">get_feature_importance</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">top_10_tree</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;top_10_tree&#39;</span>
<span class="n">top_10_tree</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c {color: black;background-color: white;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c pre{padding: 0;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-toggleable {background-color: white;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.2em 0.3em;box-sizing: border-box;text-align: center;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-estimator {font-family: monospace;background-color: #f0f8ff;margin: 0.25em 0.25em;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-estimator:hover {background-color: #d4ebff;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-item {z-index: 1;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-parallel-item:only-child::after {width: 0;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0.2em;box-sizing: border-box;padding-bottom: 0.1em;background-color: white;position: relative;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c div.sk-container {display: inline-block;position: relative;}</style><div id="sk-6688fb13-28e1-4390-86d9-19ed5a3d4c9c" class"sk-top-container"><div class="sk-container"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="1817f1c4-249f-4650-83d0-c0178e1edaf0" type="checkbox" ><label class="sk-toggleable__label" for="1817f1c4-249f-4650-83d0-c0178e1edaf0">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('pp',
                 ColumnTransformer(transformers=[('cat_encoder',
                                                  OneHotEncoder(),
                                                  ['Mfg_Month', 'Fuel_Type',
                                                   'Color']),
                                                 ('ord_encoder',
                                                  OrdinalEncoder(handle_unknown='use_encoded_value',
                                                                 unknown_value=99),
                                                  ['Mfg_Year', 'Doors',
                                                   'Gears']),
                                                 ('num_encoder',
                                                  StandardScaler(),
                                                  Index(['Age_08_04', 'KM', 'HP', 'Met_Color', 'Automatic', 'CC',
       'Quarterly_Tax', 'Weight', 'M...AG_Guarantee',
       'Guarantee_Period', 'ABS', 'Airbag_1', 'Airbag_2', 'Airco',
       'Automatic_airco', 'Boardcomputer', 'CD_Player', 'Central_Lock',
       'Powered_Windows', 'Power_Steering', 'Radio', 'Mistlamps',
       'Sport_Model', 'Backseat_Divider', 'Metallic_Rim', 'Radio_cassette',
       'Parking_Assistant', 'Tow_Bar'],
      dtype='object'))])),
                ('dtr', DecisionTreeRegressor(random_state=123))])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="54b5ed4d-21db-43c0-acc6-b2d3c40e526f" type="checkbox" ><label class="sk-toggleable__label" for="54b5ed4d-21db-43c0-acc6-b2d3c40e526f">pp: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[('cat_encoder', OneHotEncoder(),
                                 ['Mfg_Month', 'Fuel_Type', 'Color']),
                                ('ord_encoder',
                                 OrdinalEncoder(handle_unknown='use_encoded_value',
                                                unknown_value=99),
                                 ['Mfg_Year', 'Doors', 'Gears']),
                                ('num_encoder', StandardScaler(),
                                 Index(['Age_08_04', 'KM', 'HP', 'Met_Color', 'Automatic', 'CC',
       'Quarterly_Tax', 'Weight', 'Mfr_Guarantee', 'BOVAG_Guarantee',
       'Guarantee_Period', 'ABS', 'Airbag_1', 'Airbag_2', 'Airco',
       'Automatic_airco', 'Boardcomputer', 'CD_Player', 'Central_Lock',
       'Powered_Windows', 'Power_Steering', 'Radio', 'Mistlamps',
       'Sport_Model', 'Backseat_Divider', 'Metallic_Rim', 'Radio_cassette',
       'Parking_Assistant', 'Tow_Bar'],
      dtype='object'))])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="bf66a049-0fda-4295-9969-f0eb94c4d36c" type="checkbox" ><label class="sk-toggleable__label" for="bf66a049-0fda-4295-9969-f0eb94c4d36c">cat_encoder</label><div class="sk-toggleable__content"><pre>['Mfg_Month', 'Fuel_Type', 'Color']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="7054b35e-efac-4f97-945d-f528d63d82ca" type="checkbox" ><label class="sk-toggleable__label" for="7054b35e-efac-4f97-945d-f528d63d82ca">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="c23ffab5-4608-4922-ac4b-a3dcd98b81d5" type="checkbox" ><label class="sk-toggleable__label" for="c23ffab5-4608-4922-ac4b-a3dcd98b81d5">ord_encoder</label><div class="sk-toggleable__content"><pre>['Mfg_Year', 'Doors', 'Gears']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="f135a930-90ed-425f-bed3-6066eaf76f11" type="checkbox" ><label class="sk-toggleable__label" for="f135a930-90ed-425f-bed3-6066eaf76f11">OrdinalEncoder</label><div class="sk-toggleable__content"><pre>OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=99)</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="89ffd983-eafc-4cfd-908d-5977efcc8ee7" type="checkbox" ><label class="sk-toggleable__label" for="89ffd983-eafc-4cfd-908d-5977efcc8ee7">num_encoder</label><div class="sk-toggleable__content"><pre>Index(['Age_08_04', 'KM', 'HP', 'Met_Color', 'Automatic', 'CC',
       'Quarterly_Tax', 'Weight', 'Mfr_Guarantee', 'BOVAG_Guarantee',
       'Guarantee_Period', 'ABS', 'Airbag_1', 'Airbag_2', 'Airco',
       'Automatic_airco', 'Boardcomputer', 'CD_Player', 'Central_Lock',
       'Powered_Windows', 'Power_Steering', 'Radio', 'Mistlamps',
       'Sport_Model', 'Backseat_Divider', 'Metallic_Rim', 'Radio_cassette',
       'Parking_Assistant', 'Tow_Bar'],
      dtype='object')</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="e99c95ef-c77e-4b94-b231-18575be4963a" type="checkbox" ><label class="sk-toggleable__label" for="e99c95ef-c77e-4b94-b231-18575be4963a">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="12ab7c64-fd6c-4b08-914c-1202732db1a1" type="checkbox" ><label class="sk-toggleable__label" for="12ab7c64-fd6c-4b08-914c-1202732db1a1">DecisionTreeRegressor</label><div class="sk-toggleable__content"><pre>DecisionTreeRegressor(random_state=123)</pre></div></div></div></div></div></div></div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Age_08_04          0.8366
KM                 0.0403
HP                 0.0343
Weight             0.0145
Automatic_airco    0.0094
Mfg_Month_1        0.0053
Powered_Windows    0.0043
Quarterly_Tax      0.0038
Mistlamps          0.0038
CC                 0.0030
Name: top_10_tree, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Seems like the <code class="docutils literal notranslate"><span class="pre">Age</span></code>, <code class="docutils literal notranslate"><span class="pre">KM</span></code>, <code class="docutils literal notranslate"><span class="pre">HP</span></code> and <code class="docutils literal notranslate"><span class="pre">Weight</span></code> seem to be the most important variables.  Let’s take a look using a different method and see which features float to to the top.  Here we’ll try a forest of trees, this ought to give us an even better idea of which parameters are of the most value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># And now one last try using GridSearch to find the best transformer</span>
<span class="n">param_grid</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;regressor__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]}</span>

<span class="n">pipe</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s2">&quot;pp&quot;</span><span class="p">,</span><span class="n">pre_processing</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;regressor&quot;</span><span class="p">,</span><span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">))])</span>
<span class="n">reg</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe</span><span class="p">,</span><span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid</span><span class="p">)</span>
<span class="n">reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">best</span><span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">best_estimator_</span>

<span class="n">fi</span><span class="o">=</span> <span class="n">FeatureImportance</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
<span class="n">top_10_grid</span> <span class="o">=</span> <span class="n">fi</span><span class="o">.</span><span class="n">get_feature_importance</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)[:</span><span class="mi">10</span><span class="p">]</span>
<span class="n">top_10_grid</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;top_10_grid&#39;</span>
<span class="n">top_10_grid</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>#sk-1654c386-5534-44f3-9baa-4384e1d70d7d {color: black;background-color: white;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d pre{padding: 0;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-toggleable {background-color: white;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.2em 0.3em;box-sizing: border-box;text-align: center;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-estimator {font-family: monospace;background-color: #f0f8ff;margin: 0.25em 0.25em;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-estimator:hover {background-color: #d4ebff;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-item {z-index: 1;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-parallel-item:only-child::after {width: 0;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0.2em;box-sizing: border-box;padding-bottom: 0.1em;background-color: white;position: relative;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-1654c386-5534-44f3-9baa-4384e1d70d7d div.sk-container {display: inline-block;position: relative;}</style><div id="sk-1654c386-5534-44f3-9baa-4384e1d70d7d" class"sk-top-container"><div class="sk-container"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="2e066c15-183f-4548-9645-1ac69bb2d6e1" type="checkbox" ><label class="sk-toggleable__label" for="2e066c15-183f-4548-9645-1ac69bb2d6e1">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(estimator=Pipeline(steps=[('pp',
                                        ColumnTransformer(transformers=[('cat_encoder',
                                                                         OneHotEncoder(),
                                                                         ['Mfg_Month',
                                                                          'Fuel_Type',
                                                                          'Color']),
                                                                        ('ord_encoder',
                                                                         OrdinalEncoder(handle_unknown='use_encoded_value',
                                                                                        unknown_value=99),
                                                                         ['Mfg_Year',
                                                                          'Doors',
                                                                          'Gears']),
                                                                        ('num_encoder',
                                                                         StandardScaler(),
                                                                         Index(['Age_08_04', 'KM', 'HP', 'Met_Color', 'Automatic', 'CC',
       'Qua...
       'Guarantee_Period', 'ABS', 'Airbag_1', 'Airbag_2', 'Airco',
       'Automatic_airco', 'Boardcomputer', 'CD_Player', 'Central_Lock',
       'Powered_Windows', 'Power_Steering', 'Radio', 'Mistlamps',
       'Sport_Model', 'Backseat_Divider', 'Metallic_Rim', 'Radio_cassette',
       'Parking_Assistant', 'Tow_Bar'],
      dtype='object'))])),
                                       ('regressor',
                                        DecisionTreeRegressor(random_state=123))]),
             param_grid={'regressor__max_depth': [3, 4, 5]})</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="2206a914-30f1-4cba-9050-3151ada93ba0" type="checkbox" ><label class="sk-toggleable__label" for="2206a914-30f1-4cba-9050-3151ada93ba0">pp: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[('cat_encoder', OneHotEncoder(),
                                 ['Mfg_Month', 'Fuel_Type', 'Color']),
                                ('ord_encoder',
                                 OrdinalEncoder(handle_unknown='use_encoded_value',
                                                unknown_value=99),
                                 ['Mfg_Year', 'Doors', 'Gears']),
                                ('num_encoder', StandardScaler(),
                                 Index(['Age_08_04', 'KM', 'HP', 'Met_Color', 'Automatic', 'CC',
       'Quarterly_Tax', 'Weight', 'Mfr_Guarantee', 'BOVAG_Guarantee',
       'Guarantee_Period', 'ABS', 'Airbag_1', 'Airbag_2', 'Airco',
       'Automatic_airco', 'Boardcomputer', 'CD_Player', 'Central_Lock',
       'Powered_Windows', 'Power_Steering', 'Radio', 'Mistlamps',
       'Sport_Model', 'Backseat_Divider', 'Metallic_Rim', 'Radio_cassette',
       'Parking_Assistant', 'Tow_Bar'],
      dtype='object'))])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="a3e7bbb4-ee84-44a9-9209-494c9e76c1fb" type="checkbox" ><label class="sk-toggleable__label" for="a3e7bbb4-ee84-44a9-9209-494c9e76c1fb">cat_encoder</label><div class="sk-toggleable__content"><pre>['Mfg_Month', 'Fuel_Type', 'Color']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="9e85f9aa-6403-4a00-a99c-5575bbd64a35" type="checkbox" ><label class="sk-toggleable__label" for="9e85f9aa-6403-4a00-a99c-5575bbd64a35">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="3cc0a4f2-f0e2-4740-a61c-690d4bc758a7" type="checkbox" ><label class="sk-toggleable__label" for="3cc0a4f2-f0e2-4740-a61c-690d4bc758a7">ord_encoder</label><div class="sk-toggleable__content"><pre>['Mfg_Year', 'Doors', 'Gears']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="bc935c2c-629d-4b5f-8af3-0fe131c03d21" type="checkbox" ><label class="sk-toggleable__label" for="bc935c2c-629d-4b5f-8af3-0fe131c03d21">OrdinalEncoder</label><div class="sk-toggleable__content"><pre>OrdinalEncoder(handle_unknown='use_encoded_value', unknown_value=99)</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="972cd1ba-8a29-4d3d-bd26-7a986adb1240" type="checkbox" ><label class="sk-toggleable__label" for="972cd1ba-8a29-4d3d-bd26-7a986adb1240">num_encoder</label><div class="sk-toggleable__content"><pre>Index(['Age_08_04', 'KM', 'HP', 'Met_Color', 'Automatic', 'CC',
       'Quarterly_Tax', 'Weight', 'Mfr_Guarantee', 'BOVAG_Guarantee',
       'Guarantee_Period', 'ABS', 'Airbag_1', 'Airbag_2', 'Airco',
       'Automatic_airco', 'Boardcomputer', 'CD_Player', 'Central_Lock',
       'Powered_Windows', 'Power_Steering', 'Radio', 'Mistlamps',
       'Sport_Model', 'Backseat_Divider', 'Metallic_Rim', 'Radio_cassette',
       'Parking_Assistant', 'Tow_Bar'],
      dtype='object')</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="88ea4676-f244-44cb-8c55-d764062a2fa1" type="checkbox" ><label class="sk-toggleable__label" for="88ea4676-f244-44cb-8c55-d764062a2fa1">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="627a87d6-a39a-480e-88f2-144d5c8083c4" type="checkbox" ><label class="sk-toggleable__label" for="627a87d6-a39a-480e-88f2-144d5c8083c4">DecisionTreeRegressor</label><div class="sk-toggleable__content"><pre>DecisionTreeRegressor(random_state=123)</pre></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Age_08_04          0.9058
HP                 0.0370
KM                 0.0264
Weight             0.0075
Automatic_airco    0.0065
Mfg_Month_1        0.0053
Mistlamps          0.0040
Powered_Windows    0.0036
Quarterly_Tax      0.0021
Mfg_Year           0.0009
Name: top_10_grid, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Now that we have both using a standard regressor and using GridSearch, let&#39;s compare</span>
<span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">top_10_grid</span><span class="p">,</span><span class="n">top_10_tree</span><span class="p">],</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>top_10_grid</th>
      <th>top_10_tree</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Age_08_04</th>
      <td>0.9058</td>
      <td>0.8366</td>
    </tr>
    <tr>
      <th>HP</th>
      <td>0.0370</td>
      <td>0.0343</td>
    </tr>
    <tr>
      <th>KM</th>
      <td>0.0264</td>
      <td>0.0403</td>
    </tr>
    <tr>
      <th>Weight</th>
      <td>0.0075</td>
      <td>0.0145</td>
    </tr>
    <tr>
      <th>Automatic_airco</th>
      <td>0.0065</td>
      <td>0.0094</td>
    </tr>
    <tr>
      <th>Mfg_Month_1</th>
      <td>0.0053</td>
      <td>0.0053</td>
    </tr>
    <tr>
      <th>Mistlamps</th>
      <td>0.0040</td>
      <td>0.0038</td>
    </tr>
    <tr>
      <th>Powered_Windows</th>
      <td>0.0036</td>
      <td>0.0043</td>
    </tr>
    <tr>
      <th>Quarterly_Tax</th>
      <td>0.0021</td>
      <td>0.0038</td>
    </tr>
    <tr>
      <th>Mfg_Year</th>
      <td>0.0009</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>CC</th>
      <td>NaN</td>
      <td>0.0030</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Knowing what the top ten differentiating factors are help us to narrow the focus of our predictive models going forward.  Since we know for instance that a multiple linear regression model will continually improve as we add more variables (maybe insignificantly) and if we want to be able to explain our model, keeping to the most impactful variables most helpful.</p>
<p>At this point, we could just decide to keep a managable number of factors and restart our entire process from scratch.  (Frankly this is what happens when alot of the samples are explained.  All the work that we’ve done here so far, is left out so that the learner is not subjected to the steps which simply eliminate useless information.)  Since all the work has been done, we are just going to move on keeping in all the features and letting the algorithm reduce the featureset as appropriate.</p>
</section>
<section id="making-predictions">
<h2>Making predictions<a class="headerlink" href="#making-predictions" title="Permalink to this headline">#</a></h2>
<p>At this point we have done a thorough job of exploring the data, finding possible outliers, eliminating features and  coming up with a candidate list of good features.  We’ll try a couple of different approaches finding a good predictive fit for the price.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_cars</span> <span class="o">=</span> <span class="n">cars_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="s1">&#39;Price&#39;</span><span class="p">)</span>
<span class="n">y_cars</span> <span class="o">=</span> <span class="n">cars_df</span><span class="p">[</span><span class="s1">&#39;Price&#39;</span><span class="p">]</span>

<span class="n">c_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mfg_Month&#39;</span><span class="p">,</span><span class="s1">&#39;Fuel_Type&#39;</span><span class="p">,</span><span class="s1">&#39;Color&#39;</span><span class="p">]</span>
<span class="n">o_cols</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Mfg_Year&#39;</span><span class="p">,</span><span class="s1">&#39;Doors&#39;</span><span class="p">,</span> <span class="s1">&#39;Gears&#39;</span><span class="p">]</span>
<span class="n">b_cols</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="s1">&#39;bool&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>
<span class="n">n_cols</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">)</span><span class="o">.</span><span class="n">columns</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_cars</span><span class="p">,</span><span class="n">y_cars</span><span class="p">,</span><span class="n">test_size</span> <span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

<span class="c1"># We&#39;re going to setup our column transformer as pre-processing step for the follow-on steps.</span>
<span class="n">pre_processing_transform</span> <span class="o">=</span> <span class="n">ColumnTransformer</span><span class="p">([</span>
    <span class="p">(</span><span class="s1">&#39;cat_encoder&#39;</span><span class="p">,</span> <span class="n">OneHotEncoder</span><span class="p">(),</span> <span class="n">c_cols</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;ord_encoder&#39;</span><span class="p">,</span> <span class="n">OrdinalEncoder</span><span class="p">(</span><span class="n">handle_unknown</span><span class="o">=</span><span class="s1">&#39;use_encoded_value&#39;</span><span class="p">,</span><span class="n">unknown_value</span><span class="o">=</span><span class="mi">99</span><span class="p">),</span> <span class="n">o_cols</span><span class="p">),</span>
    <span class="p">(</span><span class="s1">&#39;num_encoder&#39;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">(),</span><span class="n">n_cols</span><span class="p">)])</span>

<span class="n">X_train</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;ABS&#39;, &#39;Age_08_04&#39;, &#39;Airbag_1&#39;, &#39;Airbag_2&#39;, &#39;Airco&#39;, &#39;Automatic&#39;,
       &#39;Automatic_airco&#39;, &#39;BOVAG_Guarantee&#39;, &#39;Backseat_Divider&#39;,
       &#39;Boardcomputer&#39;, &#39;CC&#39;, &#39;CD_Player&#39;, &#39;Central_Lock&#39;, &#39;Color&#39;, &#39;Doors&#39;,
       &#39;Fuel_Type&#39;, &#39;Gears&#39;, &#39;Guarantee_Period&#39;, &#39;HP&#39;, &#39;KM&#39;, &#39;Met_Color&#39;,
       &#39;Metallic_Rim&#39;, &#39;Mfg_Month&#39;, &#39;Mfg_Year&#39;, &#39;Mfr_Guarantee&#39;, &#39;Mistlamps&#39;,
       &#39;Parking_Assistant&#39;, &#39;Power_Steering&#39;, &#39;Powered_Windows&#39;,
       &#39;Quarterly_Tax&#39;, &#39;Radio&#39;, &#39;Radio_cassette&#39;, &#39;Sport_Model&#39;, &#39;Tow_Bar&#39;,
       &#39;Weight&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ohe</span> <span class="o">=</span> <span class="n">OneHotEncoder</span><span class="p">()</span>
<span class="n">ohe</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">c_cols</span><span class="p">])</span>

<span class="n">ode</span> <span class="o">=</span> <span class="n">OrdinalEncoder</span><span class="p">()</span>
<span class="n">ode</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">X_train</span><span class="p">[</span><span class="n">o_cols</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;1148x25 sparse matrix of type &#39;&lt;class &#39;numpy.float64&#39;&gt;&#39;
	with 3444 stored elements in Compressed Sparse Row format&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 2., 2.],
       [0., 3., 2.],
       [3., 3., 2.],
       ...,
       [0., 1., 2.],
       [1., 3., 2.],
       [3., 2., 2.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">param_grid2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;reg__max_depth&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]}</span>
<span class="n">dtr</span> <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">234</span><span class="p">)</span>
<span class="n">pipe2</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([(</span><span class="s1">&#39;pre&#39;</span><span class="p">,</span><span class="n">pre_processing_transform</span><span class="p">),</span> <span class="p">(</span><span class="s2">&quot;reg&quot;</span><span class="p">,</span><span class="n">dtr</span><span class="p">)])</span>
<span class="n">dt_reg</span> <span class="o">=</span> <span class="n">GridSearchCV</span><span class="p">(</span><span class="n">pipe2</span><span class="p">,</span><span class="n">param_grid</span><span class="o">=</span><span class="n">param_grid2</span><span class="p">)</span>
<span class="n">dt_reg</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">best</span><span class="o">=</span> <span class="n">dt_reg</span><span class="o">.</span><span class="n">best_estimator_</span>
<span class="n">best</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/opt/conda/lib/python3.9/site-packages/sklearn/model_selection/_validation.py:696: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/model_selection/_validation.py&quot;, line 687, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/metrics/_scorer.py&quot;, line 397, in _passthrough_scorer
    return estimator.score(*args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/utils/metaestimators.py&quot;, line 120, in &lt;lambda&gt;
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/pipeline.py&quot;, line 618, in score
    Xt = transform.transform(Xt)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py&quot;, line 564, in transform
    Xs = self._fit_transform(X, None, _transform_one, fitted=True)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py&quot;, line 434, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 1041, in __call__
    if self.dispatch_one_batch(iterator):
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 859, in dispatch_one_batch
    self._dispatch(tasks)
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 777, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/_parallel_backends.py&quot;, line 208, in apply_async
    result = ImmediateResult(func)
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/_parallel_backends.py&quot;, line 572, in __init__
    self.results = batch()
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 262, in __call__
    return [func(*args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 262, in &lt;listcomp&gt;
    return [func(*args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/utils/fixes.py&quot;, line 222, in __call__
    return self.function(*args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/pipeline.py&quot;, line 733, in _transform_one
    res = transformer.transform(X)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py&quot;, line 471, in transform
    X_int, X_mask = self._transform(X, handle_unknown=self.handle_unknown,
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py&quot;, line 136, in _transform
    raise ValueError(msg)
ValueError: Found unknown categories [&#39;Yellow&#39;] in column 2 during transform

  warnings.warn(
/opt/conda/lib/python3.9/site-packages/sklearn/model_selection/_validation.py:696: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/model_selection/_validation.py&quot;, line 687, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/metrics/_scorer.py&quot;, line 397, in _passthrough_scorer
    return estimator.score(*args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/utils/metaestimators.py&quot;, line 120, in &lt;lambda&gt;
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/pipeline.py&quot;, line 618, in score
    Xt = transform.transform(Xt)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py&quot;, line 564, in transform
    Xs = self._fit_transform(X, None, _transform_one, fitted=True)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py&quot;, line 434, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 1041, in __call__
    if self.dispatch_one_batch(iterator):
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 859, in dispatch_one_batch
    self._dispatch(tasks)
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 777, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/_parallel_backends.py&quot;, line 208, in apply_async
    result = ImmediateResult(func)
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/_parallel_backends.py&quot;, line 572, in __init__
    self.results = batch()
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 262, in __call__
    return [func(*args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 262, in &lt;listcomp&gt;
    return [func(*args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/utils/fixes.py&quot;, line 222, in __call__
    return self.function(*args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/pipeline.py&quot;, line 733, in _transform_one
    res = transformer.transform(X)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py&quot;, line 471, in transform
    X_int, X_mask = self._transform(X, handle_unknown=self.handle_unknown,
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py&quot;, line 136, in _transform
    raise ValueError(msg)
ValueError: Found unknown categories [&#39;Yellow&#39;] in column 2 during transform

  warnings.warn(
/opt/conda/lib/python3.9/site-packages/sklearn/model_selection/_validation.py:696: UserWarning: Scoring failed. The score on this train-test partition for these parameters will be set to nan. Details: 
Traceback (most recent call last):
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/model_selection/_validation.py&quot;, line 687, in _score
    scores = scorer(estimator, X_test, y_test)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/metrics/_scorer.py&quot;, line 397, in _passthrough_scorer
    return estimator.score(*args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/utils/metaestimators.py&quot;, line 120, in &lt;lambda&gt;
    out = lambda *args, **kwargs: self.fn(obj, *args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/pipeline.py&quot;, line 618, in score
    Xt = transform.transform(Xt)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py&quot;, line 564, in transform
    Xs = self._fit_transform(X, None, _transform_one, fitted=True)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/compose/_column_transformer.py&quot;, line 434, in _fit_transform
    return Parallel(n_jobs=self.n_jobs)(
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 1041, in __call__
    if self.dispatch_one_batch(iterator):
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 859, in dispatch_one_batch
    self._dispatch(tasks)
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 777, in _dispatch
    job = self._backend.apply_async(batch, callback=cb)
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/_parallel_backends.py&quot;, line 208, in apply_async
    result = ImmediateResult(func)
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/_parallel_backends.py&quot;, line 572, in __init__
    self.results = batch()
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 262, in __call__
    return [func(*args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/joblib/parallel.py&quot;, line 262, in &lt;listcomp&gt;
    return [func(*args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/utils/fixes.py&quot;, line 222, in __call__
    return self.function(*args, **kwargs)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/pipeline.py&quot;, line 733, in _transform_one
    res = transformer.transform(X)
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py&quot;, line 471, in transform
    X_int, X_mask = self._transform(X, handle_unknown=self.handle_unknown,
  File &quot;/opt/conda/lib/python3.9/site-packages/sklearn/preprocessing/_encoders.py&quot;, line 136, in _transform
    raise ValueError(msg)
ValueError: Found unknown categories [&#39;Yellow&#39;] in column 2 during transform

  warnings.warn(
/opt/conda/lib/python3.9/site-packages/sklearn/model_selection/_search.py:922: UserWarning: One or more of the test scores are non-finite: [nan nan nan]
  warnings.warn(
</pre></div>
</div>
<div class="output text_html"><style>#sk-4b42dd82-792c-4338-aa62-16a89867609d {color: black;background-color: white;}#sk-4b42dd82-792c-4338-aa62-16a89867609d pre{padding: 0;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-toggleable {background-color: white;}#sk-4b42dd82-792c-4338-aa62-16a89867609d label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.2em 0.3em;box-sizing: border-box;text-align: center;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-4b42dd82-792c-4338-aa62-16a89867609d input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-4b42dd82-792c-4338-aa62-16a89867609d input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-estimator {font-family: monospace;background-color: #f0f8ff;margin: 0.25em 0.25em;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-estimator:hover {background-color: #d4ebff;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-item {z-index: 1;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-parallel-item:only-child::after {width: 0;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0.2em;box-sizing: border-box;padding-bottom: 0.1em;background-color: white;position: relative;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-4b42dd82-792c-4338-aa62-16a89867609d div.sk-container {display: inline-block;position: relative;}</style><div id="sk-4b42dd82-792c-4338-aa62-16a89867609d" class"sk-top-container"><div class="sk-container"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="050d648b-49d7-4001-bc5f-cd87d42069e0" type="checkbox" ><label class="sk-toggleable__label" for="050d648b-49d7-4001-bc5f-cd87d42069e0">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(estimator=Pipeline(steps=[('pre',
                                        ColumnTransformer(transformers=[('cat_encoder',
                                                                         OneHotEncoder(),
                                                                         ['Mfg_Month',
                                                                          'Fuel_Type',
                                                                          'Color']),
                                                                        ('ord_encoder',
                                                                         OrdinalEncoder(),
                                                                         ['Mfg_Year',
                                                                          'Doors',
                                                                          'Gears']),
                                                                        ('num_encoder',
                                                                         StandardScaler(),
                                                                         Index(['Age_08_04', 'KM', 'HP', 'Met_Color', 'Automatic', 'CC',
       'Quarterly_Tax', 'Weight', 'Mfr_Guarantee', 'BOVAG_Guaran...
       'Guarantee_Period', 'ABS', 'Airbag_1', 'Airbag_2', 'Airco',
       'Automatic_airco', 'Boardcomputer', 'CD_Player', 'Central_Lock',
       'Powered_Windows', 'Power_Steering', 'Radio', 'Mistlamps',
       'Sport_Model', 'Backseat_Divider', 'Metallic_Rim', 'Radio_cassette',
       'Parking_Assistant', 'Tow_Bar'],
      dtype='object'))])),
                                       ('reg',
                                        DecisionTreeRegressor(random_state=234))]),
             param_grid={'reg__max_depth': [3, 4, 5]})</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-serial"><div class="sk-item"><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="ddc43d01-dde7-4b6f-8d80-aa2534ccbd6c" type="checkbox" ><label class="sk-toggleable__label" for="ddc43d01-dde7-4b6f-8d80-aa2534ccbd6c">pre: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[('cat_encoder', OneHotEncoder(),
                                 ['Mfg_Month', 'Fuel_Type', 'Color']),
                                ('ord_encoder', OrdinalEncoder(),
                                 ['Mfg_Year', 'Doors', 'Gears']),
                                ('num_encoder', StandardScaler(),
                                 Index(['Age_08_04', 'KM', 'HP', 'Met_Color', 'Automatic', 'CC',
       'Quarterly_Tax', 'Weight', 'Mfr_Guarantee', 'BOVAG_Guarantee',
       'Guarantee_Period', 'ABS', 'Airbag_1', 'Airbag_2', 'Airco',
       'Automatic_airco', 'Boardcomputer', 'CD_Player', 'Central_Lock',
       'Powered_Windows', 'Power_Steering', 'Radio', 'Mistlamps',
       'Sport_Model', 'Backseat_Divider', 'Metallic_Rim', 'Radio_cassette',
       'Parking_Assistant', 'Tow_Bar'],
      dtype='object'))])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="c302c6eb-21d0-4363-b2f0-47699ca26bf5" type="checkbox" ><label class="sk-toggleable__label" for="c302c6eb-21d0-4363-b2f0-47699ca26bf5">cat_encoder</label><div class="sk-toggleable__content"><pre>['Mfg_Month', 'Fuel_Type', 'Color']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="711473e9-e184-49fa-9e82-fe2ff000bc66" type="checkbox" ><label class="sk-toggleable__label" for="711473e9-e184-49fa-9e82-fe2ff000bc66">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="c701806f-a4e2-46de-b90e-69242ed2d82a" type="checkbox" ><label class="sk-toggleable__label" for="c701806f-a4e2-46de-b90e-69242ed2d82a">ord_encoder</label><div class="sk-toggleable__content"><pre>['Mfg_Year', 'Doors', 'Gears']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="ec7f4a99-b5e1-45b0-8860-976c6bfd4633" type="checkbox" ><label class="sk-toggleable__label" for="ec7f4a99-b5e1-45b0-8860-976c6bfd4633">OrdinalEncoder</label><div class="sk-toggleable__content"><pre>OrdinalEncoder()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="ef3fbfd1-fe58-409f-a04b-a2651a2074ef" type="checkbox" ><label class="sk-toggleable__label" for="ef3fbfd1-fe58-409f-a04b-a2651a2074ef">num_encoder</label><div class="sk-toggleable__content"><pre>Index(['Age_08_04', 'KM', 'HP', 'Met_Color', 'Automatic', 'CC',
       'Quarterly_Tax', 'Weight', 'Mfr_Guarantee', 'BOVAG_Guarantee',
       'Guarantee_Period', 'ABS', 'Airbag_1', 'Airbag_2', 'Airco',
       'Automatic_airco', 'Boardcomputer', 'CD_Player', 'Central_Lock',
       'Powered_Windows', 'Power_Steering', 'Radio', 'Mistlamps',
       'Sport_Model', 'Backseat_Divider', 'Metallic_Rim', 'Radio_cassette',
       'Parking_Assistant', 'Tow_Bar'],
      dtype='object')</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="358778eb-b71a-4d1b-a0d1-a4e08ceb8124" type="checkbox" ><label class="sk-toggleable__label" for="358778eb-b71a-4d1b-a0d1-a4e08ceb8124">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="96292e18-1711-4ea0-a45d-90de82262f2d" type="checkbox" ><label class="sk-toggleable__label" for="96292e18-1711-4ea0-a45d-90de82262f2d">DecisionTreeRegressor</label><div class="sk-toggleable__content"><pre>DecisionTreeRegressor(random_state=234)</pre></div></div></div></div></div></div></div></div></div></div></div></div></div><div class="output text_html"><style>#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a {color: black;background-color: white;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a pre{padding: 0;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-toggleable {background-color: white;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.2em 0.3em;box-sizing: border-box;text-align: center;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-estimator {font-family: monospace;background-color: #f0f8ff;margin: 0.25em 0.25em;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-estimator:hover {background-color: #d4ebff;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 2em;bottom: 0;left: 50%;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-item {z-index: 1;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-parallel-item {display: flex;flex-direction: column;position: relative;background-color: white;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-parallel-item:only-child::after {width: 0;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0.2em;box-sizing: border-box;padding-bottom: 0.1em;background-color: white;position: relative;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-label label {font-family: monospace;font-weight: bold;background-color: white;display: inline-block;line-height: 1.2em;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-label-container {position: relative;z-index: 2;text-align: center;}#sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a div.sk-container {display: inline-block;position: relative;}</style><div id="sk-21ae11be-eb70-41a0-9b20-e5d50a672f8a" class"sk-top-container"><div class="sk-container"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="cd06304a-4de1-425b-8e2b-95436835d67f" type="checkbox" ><label class="sk-toggleable__label" for="cd06304a-4de1-425b-8e2b-95436835d67f">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[('pre',
                 ColumnTransformer(transformers=[('cat_encoder',
                                                  OneHotEncoder(),
                                                  ['Mfg_Month', 'Fuel_Type',
                                                   'Color']),
                                                 ('ord_encoder',
                                                  OrdinalEncoder(),
                                                  ['Mfg_Year', 'Doors',
                                                   'Gears']),
                                                 ('num_encoder',
                                                  StandardScaler(),
                                                  Index(['Age_08_04', 'KM', 'HP', 'Met_Color', 'Automatic', 'CC',
       'Quarterly_Tax', 'Weight', 'Mfr_Guarantee', 'BOVAG_Guarantee',
       'Guarantee_Period', 'ABS', 'Airbag_1', 'Airbag_2', 'Airco',
       'Automatic_airco', 'Boardcomputer', 'CD_Player', 'Central_Lock',
       'Powered_Windows', 'Power_Steering', 'Radio', 'Mistlamps',
       'Sport_Model', 'Backseat_Divider', 'Metallic_Rim', 'Radio_cassette',
       'Parking_Assistant', 'Tow_Bar'],
      dtype='object'))])),
                ('reg', DecisionTreeRegressor(max_depth=3, random_state=234))])</pre></div></div></div><div class="sk-serial"><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="43f4da48-94e8-4f37-9776-84ff577fea13" type="checkbox" ><label class="sk-toggleable__label" for="43f4da48-94e8-4f37-9776-84ff577fea13">pre: ColumnTransformer</label><div class="sk-toggleable__content"><pre>ColumnTransformer(transformers=[('cat_encoder', OneHotEncoder(),
                                 ['Mfg_Month', 'Fuel_Type', 'Color']),
                                ('ord_encoder', OrdinalEncoder(),
                                 ['Mfg_Year', 'Doors', 'Gears']),
                                ('num_encoder', StandardScaler(),
                                 Index(['Age_08_04', 'KM', 'HP', 'Met_Color', 'Automatic', 'CC',
       'Quarterly_Tax', 'Weight', 'Mfr_Guarantee', 'BOVAG_Guarantee',
       'Guarantee_Period', 'ABS', 'Airbag_1', 'Airbag_2', 'Airco',
       'Automatic_airco', 'Boardcomputer', 'CD_Player', 'Central_Lock',
       'Powered_Windows', 'Power_Steering', 'Radio', 'Mistlamps',
       'Sport_Model', 'Backseat_Divider', 'Metallic_Rim', 'Radio_cassette',
       'Parking_Assistant', 'Tow_Bar'],
      dtype='object'))])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="8ff188dc-707d-409a-9ca2-ff3241b20217" type="checkbox" ><label class="sk-toggleable__label" for="8ff188dc-707d-409a-9ca2-ff3241b20217">cat_encoder</label><div class="sk-toggleable__content"><pre>['Mfg_Month', 'Fuel_Type', 'Color']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="16595e23-3c6a-4d2a-85f1-49af11134968" type="checkbox" ><label class="sk-toggleable__label" for="16595e23-3c6a-4d2a-85f1-49af11134968">OneHotEncoder</label><div class="sk-toggleable__content"><pre>OneHotEncoder()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="1c50b297-59c4-4160-b3e5-c074e35c399f" type="checkbox" ><label class="sk-toggleable__label" for="1c50b297-59c4-4160-b3e5-c074e35c399f">ord_encoder</label><div class="sk-toggleable__content"><pre>['Mfg_Year', 'Doors', 'Gears']</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="bd44c5da-9f5e-44b6-b3f3-ebe7648fe660" type="checkbox" ><label class="sk-toggleable__label" for="bd44c5da-9f5e-44b6-b3f3-ebe7648fe660">OrdinalEncoder</label><div class="sk-toggleable__content"><pre>OrdinalEncoder()</pre></div></div></div></div></div></div><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="c33dbda8-1a69-48bc-b64d-2f4f84d95fb3" type="checkbox" ><label class="sk-toggleable__label" for="c33dbda8-1a69-48bc-b64d-2f4f84d95fb3">num_encoder</label><div class="sk-toggleable__content"><pre>Index(['Age_08_04', 'KM', 'HP', 'Met_Color', 'Automatic', 'CC',
       'Quarterly_Tax', 'Weight', 'Mfr_Guarantee', 'BOVAG_Guarantee',
       'Guarantee_Period', 'ABS', 'Airbag_1', 'Airbag_2', 'Airco',
       'Automatic_airco', 'Boardcomputer', 'CD_Player', 'Central_Lock',
       'Powered_Windows', 'Power_Steering', 'Radio', 'Mistlamps',
       'Sport_Model', 'Backseat_Divider', 'Metallic_Rim', 'Radio_cassette',
       'Parking_Assistant', 'Tow_Bar'],
      dtype='object')</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="66ee586f-16a5-4d4b-aed9-f4dc467eaaf9" type="checkbox" ><label class="sk-toggleable__label" for="66ee586f-16a5-4d4b-aed9-f4dc467eaaf9">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div></div></div></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="522a0e27-9617-46d4-84a6-cfb4d214c301" type="checkbox" ><label class="sk-toggleable__label" for="522a0e27-9617-46d4-84a6-cfb4d214c301">DecisionTreeRegressor</label><div class="sk-toggleable__content"><pre>DecisionTreeRegressor(max_depth=3, random_state=234)</pre></div></div></div></div></div></div></div></div></div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./book/extras"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Michael Dereszynski<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>